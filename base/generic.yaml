# Base NeuVector Helm values for generic Kubernetes clusters
# Uses nginx ingress for service exposure

# Registry configuration (override per cluster as needed)
registry: registry.neuvector.com
tag: latest

# Controller configuration
controller:
  replicas: 3
  configmap:
    enabled: false
  data:
    sysinitcfg.yaml:
      New_Service_Profile_Baseline: basic
      Scan_Config:
        Auto_Scan: true
  pvc:
    enabled: true
    storageClass: ""
    capacity: "10Gi"

# Enforcer configuration
enforcer: {}

# Manager configuration with ingress
manager:
  ingress:
    enabled: true
    host: neuvector.local  # Override per cluster
    ingressClassName: nginx
    annotations:
      nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
      nginx.ingress.kubernetes.io/ssl-redirect: "true"
  svc:
    type: ClusterIP

# Scanner configuration
scanner:
  enabled: true
  replicas: 2

# CVE updater
cve:
  updater:
    enabled: true
    schedule: "0 2 * * *"

# Federation service configuration
federation:
  managedsvc:
    type: ClusterIP

# RBAC
rbac: true
serviceAccount: neuvector
